<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AuraPro - Download fast and respon</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&display=swap');
        body { font-family: 'Plus Jakarta Sans', sans-serif; background: #020617; color: #f8fafc; overflow-x: hidden; }
        .glass-card { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(16px); border: 1px solid rgba(255, 255, 255, 0.05); }
        .btn-sultan { background: linear-gradient(135deg, #0ea5e9, #2563eb); transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .btn-sultan:hover { transform: translateY(-2px); box-shadow: 0 0 20px rgba(14, 165, 233, 0.4); }
        .shimmer { background: linear-gradient(90deg, #0f172a 25%, #1e293b 50%, #0f172a 75%); background-size: 200% 100%; animation: shimmer 1.5s infinite; }
        @keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }
        .glow-text { text-shadow: 0 0 10px rgba(14, 165, 233, 0.5); }
    </style>
</head>
<body class="min-h-screen pb-20">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        const Icon = ({ name, size = 20, className = "" }) => {
            const iconRef = useRef(null);
            useEffect(() => {
                if (window.lucide && iconRef.current) {
                    iconRef.current.innerHTML = '';
                    const i = document.createElement('i');
                    i.setAttribute('data-lucide', name);
                    i.setAttribute('style', `width: ${size}px; height: ${size}px;`);
                    i.setAttribute('class', className);
                    iconRef.current.appendChild(i);
                    window.lucide.createIcons({ elements: [i] });
                }
            }, [name, size, className]);
            return <span ref={iconRef} className="inline-flex items-center"></span>;
        };

        const App = () => {
            const MASTER_KEY = "c65dc6a2c5mshfb24b91d1f6e1f8p14dfdbjsn5fdffba5530e";
            const [url, setUrl] = useState('');
            const [loading, setLoading] = useState(false);
            const [result, setResult] = useState(null);
            const [error, setError] = useState('');
            const [activeTab, setActiveTab] = useState('tiktok');
            const [time, setTime] = useState(new Date());
            const [manualCity, setManualCity] = useState('');
            const [locationInfo, setLocationInfo] = useState({ city: 'Detecting...', country: '' });
            const [downloadProgress, setDownloadProgress] = useState({ active: false, percent: 0 });

            // Clock Logic
            useEffect(() => {
                const timer = setInterval(() => setTime(new Date()), 1000);
                return () => clearInterval(timer);
            }, []);

            useEffect(() => {
                fetch('https://ipapi.co/json/')
                    .then(res => res.json())
                    .then(data => setLocationInfo({ city: data.city, country: data.country_name }))
                    .catch(() => setLocationInfo({ city: 'Jakarta', country: 'Indonesia' }));
            }, []);

            const formatTime = (offset) => {
                const d = new Date(time.getTime() + (time.getTimezoneOffset() * 60000) + (offset * 3600000));
                return d.toLocaleTimeString('en-GB', { hour12: false });
            };

            const startAutoDownload = async (fileUrl, filename, format) => {
                setDownloadProgress({ active: true, percent: 10 });
                try {
                    const response = await fetch(fileUrl);
                    const reader = response.body.getReader();
                    const contentLength = +response.headers.get('Content-Length');
                    
                    let receivedLength = 0;
                    let chunks = []; 
                    
                    while(true) {
                        const {done, value} = await reader.read();
                        if (done) break;
                        chunks.push(value);
                        receivedLength += value.length;
                        if (contentLength) {
                            setDownloadProgress({ active: true, percent: Math.round((receivedLength / contentLength) * 100) });
                        }
                    }

                    const blob = new Blob(chunks);
                    const bUrl = window.URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = bUrl;
                    a.download = `Skyzo_${Date.now()}.${format}`;
                    document.body.appendChild(a);
                    a.click();
                    window.URL.revokeObjectURL(bUrl);
                    document.body.removeChild(a);
                } catch (e) {
                    window.open(fileUrl, '_blank');
                } finally {
                    setTimeout(() => setDownloadProgress({ active: false, percent: 0 }), 1000);
                }
            };

            const handleExecute = async () => {
                if (!url) return;
                setLoading(true);
                setError('');
                setResult(null);

                try {
                    let apiUrl = "";
                    let options = { headers: { 'x-rapidapi-key': MASTER_KEY } };

                    if (activeTab === 'tiktok') {
                        apiUrl = 'https://tiktok-video-no-watermark2.p.rapidapi.com/';
                        options.method = 'POST';
                        options.headers['Content-Type'] = 'application/x-www-form-urlencoded';
                        options.body = new URLSearchParams({ url, hd: '1' });
                    } else {
                        apiUrl = 'https://social-download-all-in-one.p.rapidapi.com/v1/social/autolink';
                        options.method = 'POST';
                        options.headers['Content-Type'] = 'application/json';
                        options.body = JSON.stringify({ url });
                    }

                    const res = await fetch(apiUrl, options);
                    const data = await res.json();

                    if (activeTab === 'tiktok' && data.data) {
                        setResult({
                            title: data.data.title || 'TikTok Content',
                            thumbnail: data.data.cover,
                            video_hd: data.data.hdplay || data.data.play,
                            video_wm: data.data.wmplay,
                            audio: data.data.music,
                            author: data.data.author?.nickname || 'Sultan User'
                        });
                    } else if (data.medias) {
                        setResult({
                            title: data.title || 'Universal Media',
                            thumbnail: data.thumbnail,
                            video_hd: data.medias.find(m => m.quality === 'hd')?.url || data.medias[0].url,
                            video_wm: data.medias.find(m => m.quality === 'sd')?.url,
                            audio: data.medias.find(m => m.extension === 'mp3')?.url || data.medias[0].url,
                            author: data.source || 'Internet'
                        });
                    } else {
                        throw new Error("Link tidak valid atau konten privat.");
                    }
                } catch (e) {
                    setError("Ekstraksi gagal. Pastikan link benar.");
                } finally {
                    setLoading(false);
                }
            };

            return (
                <div className="max-w-5xl mx-auto px-4 py-8">
                    <div className="grid grid-cols-1 md:grid-cols-4 gap-4 mb-10">
                        <div className="glass-card p-5 rounded-3xl border-blue-500/20 md:col-span-1">
                            <div className="flex items-center gap-3 text-blue-400 mb-2">
                                <Icon name="map-pin" size={16} />
                                <span className="text-[10px] font-black uppercase tracking-widest">Location</span>
                            </div>
                            <h3 className="text-white font-bold text-lg">{manualCity || locationInfo.city}</h3>
                            <p className="text-slate-500 text-[10px] uppercase font-bold">{locationInfo.country || 'Detecting...'}</p>
                        </div>
                        <div className="md:col-span-3 glass-card p-5 rounded-3xl flex justify-around items-center">
                            {[{n:'WIB', o:7}, {n:'WITA', o:8}, {n:'WIT', o:9}].map(z => (
                                <div key={z.n} className="text-center">
                                    <p className="text-[9px] font-black text-slate-500 mb-1">{z.n}</p>
                                    <p className="text-xl font-black text-white font-mono glow-text">{formatTime(z.o)}</p>
                                </div>
                            ))}
                        </div>
                    </div>

                    <div className="text-center mb-12">
                        <h1 className="text-5xl font-extrabold text-white mb-4 tracking-tighter italic uppercase">aura<span className="text-blue-500">DV</span> <span className="text-xs align-top bg-blue-600 text-white px-2 py-1 rounded italic">pro</span></h1>
                        <p className="text-slate-400">Gak perlu repot ke browser lagi. Klik, download, simpan.</p>
                    </div>

                    <div className="flex justify-center gap-2 mb-6">
                        {['tiktok (link)', 'universal (all sosmed)'].map(t => (
                            <button key={t} onClick={() => { setActiveTab(t); setResult(null); }} className={`px-8 py-3 rounded-2xl text-[10px] font-black uppercase tracking-widest transition-all ${activeTab === t ? 'bg-blue-600 text-white' : 'bg-slate-800 text-slate-500'}`}>
                                {t} 
                            </button>
                        ))}
                    </div>

                    <div className="glass-card p-2 rounded-[2.5rem] mb-10 flex flex-col md:flex-row gap-2">
                        <input 
                            type="text" 
                            value={url}
                            onChange={(e) => setUrl(e.target.value)}
                            placeholder={`Masukkan link ${activeTab}...`} 
                            className="flex-1 bg-transparent px-8 py-6 text-white outline-none font-medium"
                        />
                        <button onClick={handleExecute} disabled={loading} className="btn-sultan px-12 py-6 rounded-[2rem] font-black text-white flex items-center justify-center gap-2">
                            {loading ? <Icon name="loader-2" className="animate-spin" /> : "EKSTRAKSI LOCAL"}
                        </button>
                    </div>

                    {downloadProgress.active && (
                        <div className="mb-10 space-y-2 animate-pulse">
                            <div className="flex justify-between text-[10px] font-black text-blue-400 uppercase tracking-widest">
                                <span>Menyimpan ke Galeri...</span>
                                <span>{downloadProgress.percent}%</span>
                            </div>
                            <div className="w-full h-2 bg-slate-800 rounded-full overflow-hidden">
                                <div className="h-full bg-blue-500 transition-all duration-300" style={{width: `${downloadProgress.percent}%`}}></div>
                            </div>
                        </div>
                    )}

                    {result && (
                        <div className="glass-card rounded-[3.5rem] overflow-hidden grid grid-cols-1 md:grid-cols-2 animate-in fade-in slide-in-from-bottom-10 duration-500">
                            <div className="relative group">
                                <img src={result.thumbnail} className="w-full aspect-[4/5] md:aspect-auto h-full object-cover" />
                                <div className="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent flex items-end p-8">
                                    <div>
                                        <p className="text-blue-400 text-[10px] font-black uppercase tracking-[0.3em] mb-2 italic">Creator: {result.author}</p>
                                        <h2 className="text-2xl font-bold text-white line-clamp-2">{result.title}</h2>
                                    </div>
                                </div>
                            </div>
                            <div className="p-10 space-y-4">
                                <div className="flex items-center gap-2 text-blue-500 mb-6">
                                    <Icon name="check-circle" size={18} />
                                    <span className="text-xs font-black uppercase tracking-widest italic text-white">Media Terdeteksi</span>
                                </div>
                                
                                <button onClick={() => startAutoDownload(result.video_hd, 'video_hd', 'mp4')} className="w-full group flex items-center justify-between p-6 bg-white/5 border border-white/5 rounded-3xl hover:bg-blue-600 transition-all">
                                    <div className="flex items-center gap-4">
                                        <div className="p-3 bg-blue-500/20 rounded-2xl text-blue-400 group-hover:text-white group-hover:bg-white/20"><Icon name="video" /></div>
                                        <div className="text-left">
                                            <p className="text-sm font-bold text-white group-hover:text-white">Download Video HD</p>
                                            <p className="text-[10px] text-slate-500 font-bold group-hover:text-blue-200">TANPA WATERMARK</p>
                                        </div>
                                    </div>
                                    <Icon name="arrow-down-circle" className="text-slate-600 group-hover:text-white" />
                                </button>

                                {result.video_wm && (
                                    <button onClick={() => startAutoDownload(result.video_wm, 'video_wm', 'mp4')} className="w-full group flex items-center justify-between p-6 bg-white/5 border border-white/5 rounded-3xl hover:bg-slate-700 transition-all">
                                        <div className="flex items-center gap-4">
                                            <div className="p-3 bg-slate-800 rounded-2xl text-slate-400"><Icon name="video" /></div>
                                            <div className="text-left text-white/50">
                                                <p className="text-sm font-bold">Download Video WM</p>
                                                <p className="text-[10px] font-bold">DENGAN WATERMARK</p>
                                            </div>
                                        </div>
                                        <Icon name="arrow-down-circle" className="text-slate-600" />
                                    </button>
                                )}

                                <button onClick={() => startAutoDownload(result.audio, 'music', 'mp3')} className="w-full group flex items-center justify-between p-6 bg-pink-500/10 border border-pink-500/20 rounded-3xl hover:bg-pink-600 transition-all">
                                    <div className="flex items-center gap-4">
                                        <div className="p-3 bg-pink-500/20 rounded-2xl text-pink-500 group-hover:text-white group-hover:bg-white/20"><Icon name="music" /></div>
                                        <div className="text-left">
                                            <p className="text-sm font-bold text-white group-hover:text-white">Download Audio MP3</p>
                                            <p className="text-[10px] text-pink-400 font-bold group-hover:text-pink-100">HQ QUALITY</p>
                                        </div>
                                    </div>
                                    <Icon name="headphones" className="text-pink-600 group-hover:text-white" />
                                </button>
                            </div>
                        </div>
                    )}

                    <div className="mt-20 glass-card p-10 rounded-[3rem] border-white/10 text-center relative overflow-hidden">
                        <div className="absolute top-0 right-0 p-4 opacity-5"><Icon name="code" size={100} /></div>
                        <p className="text-blue-500 text-[10px] font-black uppercase tracking-[0.5em] mb-4 italic">Lead System Developer</p>
                        <h4 className="text-3xl font-black text-white italic tracking-tighter mb-8 uppercase">aurapedia <span className="text-blue-500">Official</span></h4>
                        
                        <div className="flex flex-wrap justify-center gap-4">
                            <button onClick={() => window.open('https://wa.me/6288225879928?text=hello dev', '_blank')} className="flex items-center gap-3 px-8 py-4 bg-green-500/10 border border-green-500/20 text-green-500 rounded-2xl font-black text-[10px] uppercase hover:bg-green-500 hover:text-white transition-all">
                                <Icon name="message-circle" size={16} /> WhatsApp
                            </button>
                            <button onClick={() => window.open('https://instagram.com/apaca.apacu', '_blank')} className="flex items-center gap-3 px-8 py-4 bg-pink-500/10 border border-pink-500/20 text-pink-500 rounded-2xl font-black text-[10px] uppercase hover:bg-pink-600 hover:text-white transition-all">
                                <Icon name="instagram" size={16} /> Instagram
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

